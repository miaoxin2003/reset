# VSCode重置工具 2.0版本

## 版本信息
- **版本号**: 2.0
- **构建时间**: 2025-06-18 23:55:38
- **主要改进**: 彻底解决Augment进程清理问题

## 新增功能
✅ **彻底的进程清理**
- 关闭所有VSCode相关进程（Code.exe, node.exe, electron.exe）
- 专门清理Augment相关进程（augment.exe, augment-vip-windows-x86_64.exe）
- 多轮进程关闭确保彻底

✅ **强化的文件删除机制**
- 重试机制：最多3次重试，指数退避
- 强制删除：使用系统命令作为备选方案
- 递归删除：从最深层文件开始删除
- 权限处理：自动修改文件权限

✅ **专门的Augment残留清理**
- 搜索所有包含"augment"的文件夹
- 彻底清理Augment用户资产文件
- 解决"目录不是空的"错误

✅ **改进的删除顺序**
- 深度优先：按路径长度降序排序
- 分批处理：提供进度反馈
- 容错处理：即使部分失败也继续执行

## 使用方法
```
VSCode重置工具2.0版.exe              # 执行完整升级流程
VSCode重置工具2.0版.exe -s           # 显示路径
VSCode重置工具2.0版.exe -h           # 显示帮助
VSCode重置工具2.0版.exe --reset      # 仅执行重置
VSCode重置工具2.0版.exe --augment    # 仅运行Augment
VSCode重置工具2.0版.exe --plugins    # 仅安装插件
```

## 升级流程
1. **彻底关闭进程** - 多轮关闭VSCode和Augment相关进程
2. **运行Augment安装** - 以管理员身份运行Augment安装程序
3. **清理Augment残留** - 专门清理Augment残留文件
4. **重置VSCode配置** - 使用强化删除机制重置配置
5. **安装插件** - 自动安装指定的VSIX插件

## 故障排除
如果仍有问题：
1. 以管理员身份运行
2. 检查杀毒软件是否拦截
3. 查看日志文件: vscode_reset_log.txt
4. 确保在虚拟机中测试
5. 检查Augment程序路径和VSIX文件夹
